function dependOn(){"use strict";return[require("util"),require("common"),require("analytics"),require("proxy"),require("communicate")]}var def;require=function(e){"use strict";return e},def=window.define?window.define:function(e,r){"use strict";return r.apply(null,[{ajax:$.ajax.bind($)}])};var exports=acom_analytics={};def(dependOn(),function(c,e,r,d,n){"use strict";var t,s,u,o=null;for(t in s=function(){return n.getModule("upload")},u=function(){return n.getModule("download-manager")},o||(o=new function(){var i,a,l;this.proxy=d.proxy.bind(this),zip.workerScriptsPath="/lib/libs/",this.compress=function(e,r){var n=new zip.BlobWriter;i=JSON.parse(e),zip.createWriter(n,function(e){var t;function o(){a.close(function(e){c.consoleLog("closing writer"),s().uploadHTML(e,r).done(d.proxy(u().uploadHandler)),saveAs(e,"test.zip"),a=null})}(a=e).add("index.html",new zip.TextReader(i.html),function(){c.consoleLog("Added main html file"),function e(r){if(t=i.refs[r])if(t.data){var n;l=new zip.TextReader(t.data),"html"===t.type?n=t.placeholder:"css"===t.type?n="refs/"+t.placeholder.replace(/refs\//,""):"image"===t.type?(n="refs/"+t.placeholder.replace(/refs\//,""),l=new zip.Data64URIReader(t.data)):n="refs/"+t.placeholder.replace(/refs\//,""),a.add(n,l,function(){c.consoleLog("Added ref file"),(r+=1)<i.refs.length?e(r):o()})}else c.consoleLog("empty data"),c.consoleLogDir(t),r===i.refs.length?o():e(r+=1);else o()}(0)})},function(){c.consoleLog("Error occured while creating zip writer.")})}},n.registerModule("convert-to-zip",o)),o)o.hasOwnProperty(t)&&("function"==typeof o[t]?exports[t]=o[t].bind(o):exports[t]=o[t]);return o});