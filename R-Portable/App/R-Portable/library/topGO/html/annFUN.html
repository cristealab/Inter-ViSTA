<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Functions which map gene identifiers to GO terms</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for annFUN {topGO}"><tr><td>annFUN {topGO}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Functions which map gene identifiers to GO terms</h2>

<h3>Description</h3>

<p>These functions are used to compile a list of GO terms such that each
element in the list is a character vector containing all the gene
identifiers that are mapped to the respective GO term.  
</p>


<h3>Usage</h3>

<pre>
annFUN.db(whichOnto, feasibleGenes = NULL, affyLib)
annFUN.org(whichOnto, feasibleGenes = NULL, mapping, ID = "entrez") 
annFUN(whichOnto, feasibleGenes = NULL, affyLib)
annFUN.gene2GO(whichOnto, feasibleGenes = NULL, gene2GO)
annFUN.GO2genes(whichOnto, feasibleGenes = NULL, GO2genes)
annFUN.file(whichOnto, feasibleGenes = NULL, file, ...)

readMappings(file, sep = "\t", IDsep = ",")
inverseList(l)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>whichOnto</code></td>
<td>
<p>character string specifying one of the three GO
ontologies, namely: <code>"BP"</code>, <code>"MF"</code>, <code>"CC"</code></p>
</td></tr>
<tr valign="top"><td><code>feasibleGenes</code></td>
<td>
<p>character vector containing a subset of gene
identifiers. Only these genes will be used to annotate GO
terms. Default value is <code>NULL</code> which means that there are no
genes filtered.</p>
</td></tr>
<tr valign="top"><td><code>affyLib</code></td>
<td>
<p>character string containing the name of the
Bioconductor annotaion package for a specific microarray chip.</p>
</td></tr>
<tr valign="top"><td><code>gene2GO</code></td>
<td>
<p>named list of character vectors. The list names are
genes identifiers. For each gene the character vector contains the
GO identifiers it maps to. Only the most specific annotations are required.</p>
</td></tr>
<tr valign="top"><td><code>GO2genes</code></td>
<td>
<p>named list of character vectors. The list names are
GO identifiers. For each GO the character vector contains the
genes identifiers which are mapped to it. Only the most specific
annotations are required.</p>
</td></tr>
<tr valign="top"><td><code>mapping</code></td>
<td>
<p>character string specifieng the name of the
Bioconductor package containing the gene mappings for a
specific organism. For example: <code>mapping = "org.Hs.eg.db"</code>.</p>
</td></tr>
<tr valign="top"><td><code>ID</code></td>
<td>
<p>character string specifing the gene identifier to
use. Currently only the following identifiers can be used:
<code>c("entrez", "genbank", "alias", "ensembl", "symbol",
      "genename", "unigene")</code></p>
</td></tr>
<tr valign="top"><td><code>file</code></td>
<td>
<p>character string specifing the file containing the annotations.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>other parameters</p>
</td></tr>
<tr valign="top"><td><code>sep</code></td>
<td>
<p>the character used to separate the columns in the CSV file</p>
</td></tr>
<tr valign="top"><td><code>IDsep</code></td>
<td>
<p>the character used to separate the annotated entities</p>
</td></tr>
<tr valign="top"><td><code>l</code></td>
<td>
<p>a list containing mappings</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All these function restrict the GO terms to the ones belonging
to the specified ontology and to the genes listed in the
<code>feasibleGenes</code> attribute (if not empty).
</p>
<p>The function <code>annFUN.db</code> uses the mappings provided
in the Bioconductor annotation data packages. For example, if the
Affymetrix <code>hgu133a</code> chip it is used, then the user should set
<code>affyLib = "hgu133a.db"</code>.
</p>
<p>The functions <code>annFUN.gene2GO</code> and <code>annFUN.GO2genes</code> are
used when the user provide his own annotations either as a gene-to-GOs
mapping, either as a GO-to-genes mapping.
</p>
<p>The <code>annFUN.org</code> function is using the mappings from the
&quot;org.XX.XX&quot; annotation packages. The function supports different gene
identifiers.
</p>
<p>The <code>annFUN.file</code> function will read the annotationsof the type
gene2GO or GO2genes from a text file.          
</p>


<h3>Value</h3>

<p>A named(GO identifiers) list of character vectors. 
</p>


<h3>Author(s)</h3>

<p>Adrian Alexa</p>


<h3>See Also</h3>

<p><code><a href="topGOdata-class.html">topGOdata-class</a></code>
</p>


<h3>Examples</h3>

<pre>

library(hgu133a.db)
set.seed(111)

## generate a gene list and the GO annotations
selGenes &lt;- sample(ls(hgu133aGO), 50)
gene2GO &lt;- lapply(mget(selGenes, envir = hgu133aGO), names)
gene2GO[sapply(gene2GO, is.null)] &lt;- NA

## the annotation for the first three genes
gene2GO[1:3]

## inverting the annotations
G2g &lt;- inverseList(gene2GO)

## inverting the annotations and selecting an ontology
go2genes &lt;- annFUN.gene2GO(whichOnto = "CC", gene2GO = gene2GO)


## generate a GO list with the genes annotations
selGO &lt;- sample(ls(hgu133aGO2PROBE), 30)
GO2gene &lt;- lapply(mget(selGO, envir = hgu133aGO2PROBE), as.character)

GO2gene[1:3]

## select only the GO terms for a specific ontology
go2gene &lt;- annFUN.GO2genes(whichOnto = "CC", GO2gene = GO2gene)


##################################################
## Using the org.XX.xx.db annotations
##################################################

## GO to Symbol mappings (only the BP ontology is used)
xx &lt;- annFUN.org("BP", mapping = "org.Hs.eg.db", ID = "symbol")
head(xx)

## Not run: 

allGenes &lt;- unique(unlist(xx))
myInterestedGenes &lt;- sample(allGenes, 500)
geneList &lt;- factor(as.integer(allGenes 
names(geneList) &lt;- allGenes

GOdata &lt;- new("topGOdata",
              ontology = "BP",
              allGenes = geneList,
              nodeSize = 5,
              annot = annFUN.org, 
              mapping = "org.Hs.eg.db",
              ID = "symbol") 

## End(Not run)

</pre>

<hr /><div style="text-align: center;">[Package <em>topGO</em> version 2.34.0 <a href="00Index.html">Index</a>]</div>
</body></html>
